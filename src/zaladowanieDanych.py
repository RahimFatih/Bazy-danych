import mysql.connector
import os
from pathlib import Path

mydb = mysql.connector.connect(
  host="localhost",
  user="yourusername",
  password="yourpassword"
)
mycursor = mydb.cursor()


for filename in os.listdir(os.path.join(os.path.realpath('.'),os.path.realpath('src/dane'))):
    if filename.endswith(".csv"): 
        with open(os.path.join(os.path.realpath('./src/dane/'+filename))) as file:
            sql=""
            val=[]
            for i, line in enumerate(file):
                if(i==0):
                    sql="INSERT INTO "+filename+" ("+line+") VALUES (%s"
                    for columns in range(len(line.split(","))-1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :
                        sql=sql+", %s"
                    sql=sql+")"
                else:
                    val.append(line.rstrip().split(","))
            mycursor.execute(sql, val)
    else:
        continue
mydb.commit()
print(mycursor.rowcount, "record inserted.")
#print(mydb)